{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* eslint-disable no-return-assign */\nimport { Row, Col, message, Pagination } from 'antd';\nimport Head from 'next/head';\nimport React, { PureComponent, createRef } from 'react';\nimport PurchasedVideoCard from 'src/components/videos/purchased-video-card';\nimport { videoService } from 'src/services';\nimport PopupVideoDetail from 'src/components/videos/popup-video';\nimport { getResponseError } from 'src/lib';\nimport PageHeader from '@components/common/layout/page-header';\nimport Loader from '@components/common/base/loader';\n\nclass PurchasedVideoPage extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"popupRef\", /*#__PURE__*/createRef());\n\n    this.state = {\n      limit: 12,\n      offset: 0,\n      transactions: [],\n      loading: false,\n      success: false,\n      total: 0\n    };\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  async loadData() {\n    const {\n      limit,\n      offset\n    } = this.state;\n\n    try {\n      this.setState({\n        loading: true\n      });\n      const resp = await videoService.purchased({\n        limit,\n        offset\n      });\n      this.setState({\n        transactions: resp.data.data,\n        success: true,\n        total: resp.data.total\n      });\n    } catch (error) {\n      this.showError(error);\n    } finally {\n      this.setState({\n        loading: false\n      });\n    }\n  }\n\n  async pageChange(page) {\n    const {\n      limit\n    } = this.state;\n    await this.setState({\n      offset: (page - 1) * limit\n    });\n    this.loadData();\n  }\n\n  async showError(e) {\n    const err = await Promise.resolve(e);\n    message.error(getResponseError(err));\n  }\n\n  async playVideo(videoId) {\n    var _video$data, _video$data$video, _video$data2, _video$data2$video;\n\n    const video = await videoService.userFindVideoById(videoId);\n    this.popupRef.showModalBuyAssets((_video$data = video.data) === null || _video$data === void 0 ? void 0 : (_video$data$video = _video$data.video) === null || _video$data$video === void 0 ? void 0 : _video$data$video.url);\n\n    if ((_video$data2 = video.data) !== null && _video$data2 !== void 0 && (_video$data2$video = _video$data2.video) !== null && _video$data2$video !== void 0 && _video$data2$video.url) {\n      videoService.increaseView(videoId);\n    }\n\n    return true;\n  }\n\n  render() {\n    const {\n      transactions,\n      success,\n      total,\n      limit,\n      loading\n    } = this.state;\n    return __jsx(React.Fragment, null, __jsx(Head, null, __jsx(\"title\", null, \"My Purchased Videos\")), __jsx(\"div\", {\n      className: \"main-profile-background\"\n    }, __jsx(PageHeader, {\n      title: \"Purchased Videos\"\n    }), __jsx(\"div\", {\n      className: \"purchased-videos-page pad40\"\n    }, loading && __jsx(Loader, {\n      spinning: true,\n      fullScreen: true\n    }), success && transactions.length > 0 ? __jsx(React.Fragment, null, __jsx(Row, null, transactions.map(transaction => __jsx(Col, {\n      lg: 6,\n      md: 8,\n      sm: 12,\n      xs: 24,\n      key: transaction._id,\n      style: {\n        padding: '0 10px'\n      }\n    }, __jsx(PurchasedVideoCard, {\n      video: transaction.targetInfo,\n      performer: transaction.sellerInfo,\n      onClick: () => this.playVideo(transaction.targetId)\n    }))), total > limit && __jsx(Col, {\n      sm: 24,\n      style: {\n        textAlign: 'center'\n      }\n    }, __jsx(Pagination, {\n      onChange: this.pageChange.bind(this),\n      defaultCurrent: 1,\n      pageSize: limit,\n      total: total\n    })))) : __jsx(\"div\", {\n      className: \"pad20\"\n    }, \"You have not purchased any videos yet.\"))), __jsx(\"div\", {\n      className: \"popup-video\"\n    }, __jsx(PopupVideoDetail, {\n      ref: ref => this.popupRef = ref\n    })));\n  }\n\n}\n\n_defineProperty(PurchasedVideoPage, \"authenticate\", true);\n\n_defineProperty(PurchasedVideoPage, \"layout\", 'primary');\n\nexport default PurchasedVideoPage;","map":{"version":3,"sources":["/Users/frag-games/Desktop/Test Projects/secret-client/pages/account/user/purchased-video/index.tsx"],"names":["Row","Col","message","Pagination","Head","React","PureComponent","createRef","PurchasedVideoCard","videoService","PopupVideoDetail","getResponseError","PageHeader","Loader","PurchasedVideoPage","constructor","props","state","limit","offset","transactions","loading","success","total","componentDidMount","loadData","setState","resp","purchased","data","error","showError","pageChange","page","e","err","Promise","resolve","playVideo","videoId","video","userFindVideoById","popupRef","showModalBuyAssets","url","increaseView","render","length","map","transaction","_id","padding","targetInfo","sellerInfo","targetId","textAlign","bind","ref"],"mappings":"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","sourcesContent":["/* eslint-disable no-return-assign */\nimport {\n  Row, Col, message, Pagination\n} from 'antd';\nimport Head from 'next/head';\nimport React, { PureComponent, createRef } from 'react';\nimport PurchasedVideoCard from 'src/components/videos/purchased-video-card';\nimport { videoService } from 'src/services';\nimport PopupVideoDetail from 'src/components/videos/popup-video';\nimport { getResponseError } from 'src/lib';\nimport PageHeader from '@components/common/layout/page-header';\nimport Loader from '@components/common/base/loader';\n\ninterface IProps {}\ninterface IStates {\n  limit: number;\n  offset: number;\n  transactions: any[];\n  loading: boolean;\n  success: boolean;\n  total: number;\n}\n\nclass PurchasedVideoPage extends PureComponent<IProps, IStates> {\n  static authenticate = true;\n\n  static layout = 'primary';\n\n  popupRef = createRef() as any;\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      limit: 12,\n      offset: 0,\n      transactions: [],\n      loading: false,\n      success: false,\n      total: 0\n    };\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  async loadData() {\n    const { limit, offset } = this.state;\n    try {\n      this.setState({ loading: true });\n      const resp = await videoService.purchased({\n        limit,\n        offset\n      });\n      this.setState({\n        transactions: resp.data.data,\n        success: true,\n        total: resp.data.total\n      });\n    } catch (error) {\n      this.showError(error);\n    } finally {\n      this.setState({ loading: false });\n    }\n  }\n\n  async pageChange(page) {\n    const { limit } = this.state;\n    await this.setState({ offset: (page - 1) * limit });\n    this.loadData();\n  }\n\n  async showError(e) {\n    const err = await Promise.resolve(e);\n    message.error(getResponseError(err));\n  }\n\n  async playVideo(videoId: string) {\n    const video = await videoService.userFindVideoById(videoId);\n    this.popupRef.showModalBuyAssets(video.data?.video?.url);\n    if (video.data?.video?.url) {\n      videoService.increaseView(videoId);\n    }\n    return true;\n  }\n\n  render() {\n    const {\n      transactions, success, total, limit, loading\n    } = this.state;\n    return (\n      <>\n        <Head>\n          <title>My Purchased Videos</title>\n        </Head>\n        <div className=\"main-profile-background\">\n          <PageHeader title=\"Purchased Videos\" />\n          <div className=\"purchased-videos-page pad40\">\n            {loading && <Loader spinning fullScreen />}\n            {success && transactions.length > 0 ? (\n              <>\n                <Row>\n                  {transactions.map((transaction) => (\n                    <Col\n                      lg={6}\n                      md={8}\n                      sm={12}\n                      xs={24}\n                      key={transaction._id}\n                      style={{ padding: '0 10px' }}\n                    >\n                      <PurchasedVideoCard\n                        video={transaction.targetInfo}\n                        performer={transaction.sellerInfo}\n                        onClick={() => this.playVideo(transaction.targetId)}\n                      />\n                    </Col>\n                  ))}\n                  {total > limit && (\n                  <Col sm={24} style={{ textAlign: 'center' }}>\n                    <Pagination\n                      onChange={this.pageChange.bind(this)}\n                      defaultCurrent={1}\n                      pageSize={limit}\n                      total={total}\n                    />\n                  </Col>\n                  )}\n                </Row>\n              </>\n            ) : (\n              <div className=\"pad20\">\n                You have not purchased any videos yet.\n              </div>\n            )}\n          </div>\n        </div>\n        <div className=\"popup-video\">\n          <PopupVideoDetail ref={(ref) => (this.popupRef = ref)} />\n        </div>\n      </>\n    );\n  }\n}\nexport default PurchasedVideoPage;\n"]},"metadata":{},"sourceType":"module"}