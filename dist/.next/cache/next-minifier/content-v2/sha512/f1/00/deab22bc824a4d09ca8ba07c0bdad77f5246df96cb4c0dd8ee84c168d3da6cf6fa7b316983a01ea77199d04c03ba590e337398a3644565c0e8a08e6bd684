{"code":"(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[41],{Dx9A:function(e,t,n){\"use strict\";var a=n(\"q1tI\"),r={icon:{tag:\"svg\",attrs:{viewBox:\"64 64 896 896\",focusable:\"false\"},children:[{tag:\"defs\",attrs:{},children:[{tag:\"style\",attrs:{}}]},{tag:\"path\",attrs:{d:\"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z\"}}]},name:\"send\",theme:\"outlined\"},o=n(\"6VBw\"),i=function(e,t){return a.createElement(o.a,Object.assign({},e,{ref:t,icon:r}))};i.displayName=\"SendOutlined\";t.a=a.forwardRef(i)},HQdG:function(e,t,n){\"use strict\";n.d(t,\"a\",(function(){return S}));var a=n(\"o0o1\"),r=n.n(a),o=n(\"HaE+\"),i=n(\"wx14\"),s=n(\"1OyB\"),c=n(\"vuIU\"),l=n(\"JX7q\"),u=n(\"Ji7U\"),d=n(\"md7G\"),f=n(\"foSv\"),p=n(\"rePB\"),b=n(\"q1tI\"),m=n.n(b),h=n(\"nOHt\"),v=n.n(h),g=n(\"fsrY\"),O=n(\"tsqr\"),y=n(\"psLn\"),R=n(\"XwMy\"),C=n(\"MoJi\"),j=m.a.createElement;function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){Object(p.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(f.a)(e);if(t){var r=Object(f.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(d.a)(this,n)}}function S(e){var t=function(t){Object(u.a)(a,t);var n=E(a);function a(e){var t;Object(s.a)(this,a),t=n.call(this,e),Object(p.a)(Object(l.a)(t),\"webRTCAdaptor\",void 0),Object(p.a)(Object(l.a)(t),\"autoRepublishIntervalJob\",void 0),Object(p.a)(Object(l.a)(t),\"onbeforeunload\",(function(){t.leaveSession()}));var r=t.props.sessionId;return t.state={initialized:!1,publish_started:!1,streamId:r},t}return Object(c.a)(a,[{key:\"componentDidMount\",value:function(){this.props.initImmediately&&this.initWebRTCAdaptor(),v.a.events.on(\"routeChangeStart\",this.onbeforeunload),window.addEventListener(\"beforeunload\",this.onbeforeunload)}},{key:\"componentWillUnmount\",value:function(){window.removeEventListener(\"beforeunload\",this.onbeforeunload),v.a.events.off(\"routeChangeStart\",this.onbeforeunload)}},{key:\"leaveSession\",value:function(){var e=this.state,t=e.streamId,n=e.publish_started,a=e.initialized,r=this.props.configs.isPlayMode;this.autoRepublishIntervalJob&&window.clearInterval(this.autoRepublishIntervalJob),this.webRTCAdaptor&&a&&(n&&t&&this.webRTCAdaptor.stop(t),!r&&this.webRTCAdaptor.closeStream(),this.webRTCAdaptor.closePeerConnection(),this.webRTCAdaptor.closeWebSocket(),this.webRTCAdaptor=void 0),this.setState({streamId:\"\",initialized:!1})}},{key:\"initWebRTCAdaptor\",value:function(e,t){var n=this,a=this.props,r=a.configs,o=a.settings,i=a.autoRepublishDisabled,s=a.callback,c=r.isPlayMode,l=R.a.debug,u=c?o[g.a.SUBSCRIBER_URL]:o[g.a.PUBLISHER_URL];if(u){if(this.webRTCAdaptor||!i){var d=r.appName||o.AntMediaAppname,f=\"\".concat(u,\"/\").concat(d,\"/websocket\"),p=\"ws://\".concat(f);window.location.protocol.startsWith(\"https\")&&(p=\"wss://\".concat(f)),this.setState({cb:e,cbError:t}),this.webRTCAdaptor=new window.WebRTCAdaptor(w(w({websocket_url:p,mediaConstraints:{video:!0,audio:!0},debug:l,peerconnection_config:{iceServers:[{urls:\"stun:stun.l.google.com:19302\"}]},sdp_constraints:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1},bandwidth:R.a.maxVideoBitrateKbps,isPlayMode:!1},r),{},{callback:function(t,a){if(\"initialized\"===t)n.setState({initialized:!0});else if(\"publish_started\"===t)n.setState({publish_started:!0,streamId:a.streamId}),n.autoRepublishIntervalJob||i||(n.autoRepublishIntervalJob=setInterval(n.checkAndRepublishIfRequired.bind(n),5e3));else if(\"publish_finished\"===t)n.setState({publish_started:!1,streamId:\"\"});else if(t===C.a.ICE_CONNECTION_STATE_CHANGED)n.setState({iceConnectionState:a.state});else if(t===C.a.REFRESH_CONNECTION){n.state.publish_started&&!i&&n.checkAndRepublishIfRequired()}else t===C.a.CLOSED&&\"undefined\"!==typeof a&&console.log(\"Connecton closed: \".concat(JSON.stringify(a)));s&&\"function\"===typeof s&&s(t,a),e&&\"function\"===typeof e&&e(t,a)},callbackError:function(e,a){t&&\"function\"===typeof t&&t(e,a),n.callbackError(e,a)}}))}}else O.b.error(\"Undefined WebsocketURL!\")}},{key:\"checkAndRepublishIfRequired\",value:function(){var e=this.state,t=e.streamId,n=e.cb,a=e.cbError;if(this.webRTCAdaptor&&t){var r=this.webRTCAdaptor.iceConnectionState(t);null!=r&&\"failed\"!==r&&\"disconnected\"!==r||(this.webRTCAdaptor.stop(t),this.webRTCAdaptor.closePeerConnection(t),this.webRTCAdaptor.closeWebSocket(),this.initWebRTCAdaptor(n,a))}}},{key:\"callbackError\",value:function(e,t){\"error callback: \".concat(JSON.stringify(e));var n=JSON.stringify(e);if(\"undefined\"!==typeof t)return n=t,void O.b.error(n);n=-1!==n.indexOf(\"NotFoundError\")?\"Camera or Mic are not found or not allowed in your device\":-1!==n.indexOf(\"NotReadableError\")||-1!==n.indexOf(\"TrackStartError\")?\"Camera or Mic is being used by some other process that does not let read the devices\":-1!==n.indexOf(\"OverconstrainedError\")||-1!==n.indexOf(\"ConstraintNotSatisfiedError\")?\"There is no device found that fits your video and audio constraints. You may change video and audio constraints\":-1!==n.indexOf(\"NotAllowedError\")||-1!==n.indexOf(\"PermissionDeniedError\")?\"You are not allowed to access camera and mic.\":-1!==n.indexOf(\"TypeError\")?\"Video/Audio is required\":-1!==n.indexOf(\"ScreenSharePermissionDenied\")?\"You are not allowed to access screen share\":-1!==n.indexOf(\"WebSocketNotConnected\")?\"WebSocket Connection is disconnected.\":-1!==n.indexOf(\"unauthorized_access\")?\"Access Denied. You don\\u2019t have permission to access\":\"\";var a=Object(y.h)();n&&O.b.error({content:n,key:a,onClick:function(){return O.b.destroy(a)}})}},{key:\"render\",value:function(){var t=this.props.forwardedRef;return j(e,Object(i.a)({},this.props,this.state,{webRTCAdaptor:this.webRTCAdaptor,initWebRTCAdaptor:this.initWebRTCAdaptor.bind(this),leaveSession:this.leaveSession.bind(this),ref:t}))}}],[{key:\"getInitialProps\",value:function(){var t=Object(o.a)(r.a.mark((function t(n){var a;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.getInitialProps,!t.t0){t.next=5;break}return t.next=4,e.getInitialProps(n);case 4:t.t0=t.sent;case 5:return a=t.t0,t.abrupt(\"return\",w({},a));case 7:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),a}(m.a.Component);return m.a.forwardRef((function(e,n){return j(t,Object(i.a)({},e,{forwardedRef:n}))}))}},\"L/eJ\":function(e,t,n){\"use strict\";var a,r=n(\"ZTPi\"),o=n(\"q1tI\"),i=n.n(o),s=n(\"1OyB\"),c=n(\"vuIU\"),l=n(\"Ji7U\"),u=n(\"md7G\"),d=n(\"foSv\"),f=n(\"TSYQ\"),p=n.n(f),b=(n(\"OVUx\"),n(\"/MKj\")),m=n(\"gxiY\"),h=n(\"o0o1\"),v=n.n(h),g=n(\"HaE+\"),O=n(\"JX7q\"),y=n(\"rePB\"),R=n(\"wd/R\"),C=n.n(R),j=n(\"YFqc\"),_=n.n(j),w=(n(\"UTbA\"),n(\"AY7M\")),E=n(\"5rEg\"),S=n(\"tsqr\"),I=n(\"Dx9A\"),T=n(\"a6RD\"),x=n.n(T),k=(n(\"qMfs\"),i.a.createElement);function P(e){var t=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(u.a)(this,n)}}a=x()((function(){return n.e(51).then(n.t.bind(null,\"x/1y\",7))}),{ssr:!1,loadableGenerated:{webpack:function(){return[\"x/1y\"]},modules:[\"emoji-picker-react\"]}});var A=function(e){Object(l.a)(n,e);var t=P(n);function n(e){var a;return Object(s.a)(this,n),a=t.call(this,e),Object(y.a)(Object(O.a)(a),\"uploadRef\",void 0),a.uploadRef=i.a.createRef(),a}return Object(c.a)(n,[{key:\"onEmojiClick\",value:function(e,t){var n=this.props.onEmojiClick;n(t)}},{key:\"render\",value:function(){return k(i.a.Fragment,null,k(a,{onEmojiClick:this.onEmojiClick.bind(this),disableAutoFocus:!0,disableSearchBar:!0,disableSkinTonePicker:!0}))}}]),n}(o.PureComponent),N=i.a.createElement;function M(e){var t=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(u.a)(this,n)}}var D=E.a.TextArea,L=function(e){Object(l.a)(n,e);var t=M(n);function n(e){var a;return Object(s.a)(this,n),a=t.call(this,e),Object(y.a)(Object(O.a)(a),\"uploadRef\",void 0),Object(y.a)(Object(O.a)(a),\"_input\",void 0),Object(y.a)(Object(O.a)(a),\"state\",{text:\"\"}),Object(y.a)(Object(O.a)(a),\"onKeyDown\",(function(e){13===e.keyCode&&a.send()})),Object(y.a)(Object(O.a)(a),\"onChange\",(function(e){a.setText(e.target.value)})),Object(y.a)(Object(O.a)(a),\"onEmojiClick\",(function(e){var t=a.state.text;a.setText(t+e.emoji)})),a.uploadRef=i.a.createRef(),a}return Object(c.a)(n,[{key:\"componentDidMount\",value:function(){this.uploadRef||(this.uploadRef=i.a.createRef()),this._input||(this._input=i.a.createRef())}},{key:\"componentDidUpdate\",value:function(e){this.props.sendMessage.success!==e.sendMessage.success&&(this.setText(\"\"),this._input&&this._input.focus())}},{key:\"setText\",value:function(e){this.setState({text:e})}},{key:\"send\",value:function(){var e=this.state.text;if(this.props.loggedIn){if(e){var t=this.props,n=t.conversation,a=t.isPublic;(0,t.sendStreamMessage)({conversationId:n._id,data:{text:e},type:n.type,isPublic:a})}}else S.b.error(\"Please login\")}},{key:\"render\",value:function(){var e=this,t=this.props.loggedIn,n=this.state.text,a=this.props,r=a.sendMessage,o=a.conversation;return this.uploadRef||(this.uploadRef=i.a.createRef()),this._input||(this._input=i.a.createRef()),N(\"div\",{className:\"compose\",hidden:!t||!o._id},N(D,{value:n,className:\"compose-input\",placeholder:\"Enter message here.\",onKeyDown:this.onKeyDown,onChange:this.onChange,disabled:r.sending,autoFocus:!0,ref:function(t){return e._input=t},rows:1}),N(\"div\",{className:\"grp-icons\"},N(I.a,{onClick:this.send.bind(this),style:{fontSize:\"25px\",marginRight:\"10px\",color:\"#fe26b3\"}}),N(\"div\",{className:\"grp-emotions\"},N(\"img\",{src:\"/emotion-ico.png\",width:\"25px\",alt:\"\"}),N(A,{onEmojiClick:this.onEmojiClick.bind(this)}))))}}]),n}(o.PureComponent),U={sendStreamMessage:m.m},B=Object(b.b)((function(e){return{loggedIn:e.auth.loggedIn,sendMessage:e.streamMessage.sendMessage}}),U)(L),z=n(\"+YFz\"),H={icon:function(e,t){return{tag:\"svg\",attrs:{viewBox:\"64 64 896 896\",focusable:\"false\"},children:[{tag:\"path\",attrs:{d:\"M911.9 283.9v.5L835.5 865c-1 8-7.9 14-15.9 14H204.5c-8.1 0-14.9-6.1-16-14l-76.4-580.6v-.6 1.6L188.5 866c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6c.1-.5.1-1 0-1.5z\",fill:t}},{tag:\"path\",attrs:{d:\"M773.6 810.6l53.9-409.4-139.8 86.1L512 252.9 336.3 487.3l-139.8-86.1 53.8 409.4h523.3zm-374.2-189c0-62.1 50.5-112.6 112.6-112.6s112.6 50.5 112.6 112.6v1c0 62.1-50.5 112.6-112.6 112.6s-112.6-50.5-112.6-112.6v-1z\",fill:t}},{tag:\"path\",attrs:{d:\"M512 734.2c61.9 0 112.3-50.2 112.6-112.1v-.5c0-62.1-50.5-112.6-112.6-112.6s-112.6 50.5-112.6 112.6v.5c.3 61.9 50.7 112.1 112.6 112.1zm0-160.9c26.6 0 48.2 21.6 48.2 48.3 0 26.6-21.6 48.3-48.2 48.3s-48.2-21.6-48.2-48.3c0-26.6 21.6-48.3 48.2-48.3z\",fill:e}},{tag:\"path\",attrs:{d:\"M188.5 865c1.1 7.9 7.9 14 16 14h615.1c8 0 14.9-6 15.9-14l76.4-580.6v-.5c.3-6.4-6.7-10.8-12.3-7.4L705 396.4 518.4 147.5a8.06 8.06 0 00-12.9 0L319 396.4 124.3 276.5c-5.5-3.4-12.6.9-12.2 7.3v.6L188.5 865zm147.8-377.7L512 252.9l175.7 234.4 139.8-86.1-53.9 409.4H250.3l-53.8-409.4 139.8 86.1z\",fill:e}}]}},name:\"crown\",theme:\"twotone\"},J=n(\"6VBw\"),V=function(e,t){return o.createElement(J.a,Object.assign({},e,{ref:t,icon:H}))};V.displayName=\"CrownTwoTone\";var q=o.forwardRef(V),F=n(\"BvKs\"),W=n(\"jsC+\"),Y=n(\"NsEo\"),G=(n(\"iZf9\"),i.a.createElement);function K(e){var t=e.data,n=e.showTimestamp,a=e.isOwner,r=e.canDelete,o=e.onDelete,i=C()(t.timestamp).format(\"LLLL\"),s=G(F.a,null,G(F.a.Item,{onClick:o},G(\"a\",null,\"delete\")));return G(\"div\",{className:Object(Y.a)(e)},t.text&&!t.isSystem&&G(\"div\",{className:\"bubble-container\"},G(\"div\",{className:\"bubble\",title:i},r&&G(W.a,{overlay:s,placement:\"topRight\"},G(\"span\",null,G(z.a,null),\" \")),t.senderInfo&&G(\"span\",{className:\"u-name\"},a&&G(q,{twoToneColor:\"#eb2f96\"}),t.senderInfo.username,\"tip\"!==t.type?\": \":\" \"),!t.imageUrl&&t.text,\" \",t.imageUrl&&G(\"a\",{title:\"Click to view full content\",href:-1===t.imageUrl.indexOf(\"http\")?\"#\":t.imageUrl,target:\"_blank\",rel:\"noreferrer\"},G(\"img\",{src:t.imageUrl,width:\"180px\",alt:\"\"})))),t.text&&t.isSystem&&G(\"p\",{style:{textAlign:\"center\",fontSize:\"14px\"}},t.text),n&&!t.isSystem&&G(\"div\",{className:\"timestamp\"},i))}var X=i.a.createElement;function Q(e){var t=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(u.a)(this,n)}}var Z=function(e){Object(l.a)(n,e);var t=Q(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r)),Object(y.a)(Object(O.a)(e),\"messagesRef\",void 0),Object(y.a)(Object(O.a)(e),\"state\",{page:1,onloadmore:!1}),Object(y.a)(Object(O.a)(e),\"onMessage\",(function(t,n){var a=e.props,r=a.receiveStreamMessageSuccess,o=a.deleteMessageSuccess;t&&(\"created\"===n&&r(t),\"deleted\"===n&&o(t))})),Object(y.a)(Object(O.a)(e),\"onDelete\",(function(t){var n=e.props.deleteMessage;t&&n({messageId:t})})),Object(y.a)(Object(O.a)(e),\"renderMessages\",(function(){var t=e.props,n=t.message,a=t.currentUser,r=t.currentPerformer,o=t.conversation,s=t.loggedIn,c=n.items,l=n.fetching,u=0,d=c&&c.length;if(!c.length&&!l){var f=s?\"There are no chat!\":X(i.a.Fragment,null,\"There are no chat, please\",X(_.a,{href:\"/auth/register\"},X(\"a\",null,\" register \")),\"or\",X(_.a,{href:\"/auth/login\"},X(\"a\",null,\" login \")),\"to send message!\");return X(K,{data:{isSystem:!0,text:f}})}for(var p=[];u<d;){var b=c[u-1],m=c[u],h=c[u+1],v=a&&a._id?a._id:r&&r._id?r._id:null,g=m.senderId===v,y=C()(m.createdAt),R=!0,j=!0,w=!0,E=o&&o.performerId===m.senderId,S=!m.isDeleted&&r&&r._id===o.performerId||!m.isDeleted&&a._id===m.senderId||!m.isDeleted&&a.roles&&a.roles.includes(\"admin\");if(b){var I=C()(b.createdAt),T=C.a.duration(y.diff(I));b.senderId===m.senderId&&T.as(\"hours\")<1&&(R=!1),T.as(\"hours\")<1&&(w=!1)}if(h){var x=C()(h.createdAt),k=C.a.duration(x.diff(y));h.senderId===m.senderId&&k.as(\"hours\")<1&&(j=!1)}m._id&&p.push(X(K,{onDelete:e.onDelete.bind(Object(O.a)(e),m._id),canDelete:S,isOwner:E,key:u,isMine:g,startsSequence:R,endsSequence:j,showTimestamp:w,data:m})),u+=1}return e.scrollToBottom(),p})),e}return Object(c.a)(n,[{key:\"componentDidMount\",value:function(){var e=Object(g.a)(v.a.mark((function e(){var t,n,a=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.messagesRef||(this.messagesRef=Object(o.createRef)()),t=this.props.conversation,n=this.context,t&&t._id&&(n&&n.on&&n.on(\"message_created_conversation_\".concat(t._id),(function(e){a.onMessage(e,\"created\")})),n&&n.on&&n.on(\"message_deleted_conversation_\".concat(t._id),(function(e){a.onMessage(e,\"deleted\")})));case 4:case\"end\":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:\"componentWillUnmount\",value:function(){var e=this.props.conversation,t=this.context;t&&t.off(\"message_created_conversation_\".concat(e._id)),t&&t.off(\"message_deleted_conversation_\".concat(e._id))}},{key:\"handleScroll\",value:function(){var e=Object(g.a)(v.a.mark((function e(t,n){var a,r,o,i,s,c,l,u,d,f;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.props,r=a.message,o=a.isPublic,i=a.loadMoreStreamMessages,s=this.state.page,c=r.fetching,l=r.items,u=r.total,d=u>l.length,f=n.target,d){e.next=7;break}return e.abrupt(\"return\");case 7:if(0!==f.scrollTop||!t._id||c||!d){e.next=11;break}return e.next=10,this.setState({page:s+1,onloadmore:!0});case 10:i({conversationId:t._id,type:t.type,limit:25,offset:25*s,isPublic:o});case 11:case\"end\":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:\"scrollToBottom\",value:function(){if(!this.state.onloadmore&&this.messagesRef&&this.messagesRef.current){var e=this.messagesRef.current;window.setTimeout((function(){e.scrollTop=e.scrollHeight}),200)}}},{key:\"render\",value:function(){var e=this.props,t=e.conversation,n=e.isPublic,a=e.message.fetching;return this.messagesRef||(this.messagesRef=Object(o.createRef)()),X(\"div\",{className:\"message-list\",ref:this.messagesRef,onScroll:this.handleScroll.bind(this,t)},t&&t._id&&X(i.a.Fragment,null,X(\"div\",{className:\"message-list-container\"},a&&X(\"p\",{className:\"text-center\"},\"fetching...\"),this.renderMessages()),X(B,{conversation:t,isPublic:n})))}}]),n}(o.PureComponent);Z.contextType=w.c;var $={loadMoreStreamMessages:m.f,receiveStreamMessageSuccess:m.j,deleteMessage:m.a,deleteMessageSuccess:m.b},ee=Object(b.b)((function(e){var t=e.streamMessage,n=t.conversationMap,a=t.activeConversation;return{message:{items:a.data&&n[a.data._id]&&n[a.data._id].items||[],total:a.data&&n[a.data._id]&&n[a.data._id].total||0,fetching:a.data&&n[a.data._id]&&n[a.data._id].fetching||!1},conversation:a.data,currentUser:e.user.current,currentPerformer:e.performer.current,loggedIn:e.auth.loggedIn}}),$)(Z),te=i.a.createElement;function ne(e){var t=function(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=Object(d.a)(e);if(t){var r=Object(d.a)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return Object(u.a)(this,n)}}var ae=function(e){Object(l.a)(n,e);var t=ne(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:\"componentDidMount\",value:function(){var e=this.props,t=e.streamId,n=e.activeConversation,a=e.getStreamConversation;!n&&t&&a({conversation:n.data,isPublic:!0})}},{key:\"render\",value:function(){var e=this.props,t=e.activeConversation,n=e.isPublic,a=e.loggedIn;return te(\"div\",{className:p()(\"message-stream\",a?\"user-logged-in\":\"\")},t&&t.data&&t.data.streamId?te(ee,{isPublic:n}):te(\"p\",null,\"No conversation found.\"))}}]),n}(o.PureComponent),re={getStreamConversation:m.d},oe=Object(b.b)((function(e){return{activeConversation:e.streamMessage.activeConversation,loggedIn:e.auth.loggedIn}}),re)(ae),ie={icon:{tag:\"svg\",attrs:{viewBox:\"64 64 896 896\",focusable:\"false\"},children:[{tag:\"path\",attrs:{d:\"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z\"}}]},name:\"stop\",theme:\"outlined\"},se=function(e,t){return o.createElement(J.a,Object.assign({},e,{ref:t,icon:ie}))};se.displayName=\"StopOutlined\";var ce=o.forwardRef(se),le=n(\"8Skl\"),ue=o.createElement,de=Object(b.b)((function(e){return{placeholderAvatarUrl:e.ui.placeholderAvatarUrl}}),{})((function(e){var t=e.loggedIn,n=e.members,a=e.currentPerformer,r=e.blockUser,o=e.placeholderAvatarUrl,i=function(e){var t=e.id;return ue(F.a,null,ue(F.a.Item,{onClick:function(){return r(t)}},ue(\"span\",null,ue(ce,{size:16}),\" \",\"Block this user\")))};return ue(\"div\",{className:\"conversation-users\"},ue(\"div\",{className:\"users\"},n.length>0&&n.map((function(e){return ue(\"div\",{className:\"user\",key:e._id},t&&a&&a._id?ue(W.a,{overlay:ue(i,{id:e._id}),placement:\"bottomLeft\",trigger:[\"hover\",\"click\"]},ue(\"span\",{className:\"username\"},ue(\"img\",{alt:\"avatar\",src:(null===e||void 0===e?void 0:e.avatar)||o,width:\"35px\",style:{borderRadius:\"50%\",marginRight:\"5px\"}}),e.username,\" \",ue(le.a,null))):ue(\"span\",{className:\"username\"},ue(\"img\",{alt:\"avatar\",src:(null===e||void 0===e?void 0:e.avatar)||\"/default-user-icon.png\",width:\"35px\",style:{borderRadius:\"50%\",marginRight:\"5px\"}}),e.username))}))))})),fe=(n(\"VUsV\"),i.a.createElement),pe=function(e){var t=e.isPublic,n=e.blockUser,a=e.activeConversation,o=e.totalParticipant,i=e.currentPerformer,s=e.loggedIn,c=e.members;return fe(\"div\",{className:\"conversation-stream\"},fe(r.a,{defaultActiveKey:\"chat_content\"},fe(r.a.TabPane,{tab:\"CHAT\",key:\"chat_content\"},a&&a.data&&a.data.streamId&&fe(oe,{isPublic:t,streamId:a.data.streamId,activeConversation:a.data})),fe(r.a.TabPane,{tab:\"USER (\".concat(o||0,\")\"),key:\"chat_user\"},fe(de,{currentPerformer:i,loggedIn:s,members:c,blockUser:n}))))};pe.defaultProps={isPublic:!1,totalParticipant:0,activeConversation:null,currentPerformer:null,loggedIn:!1,members:[],blockUser:null};t.a=pe},MoJi:function(e,t,n){\"use strict\";var a;n.d(t,\"a\",(function(){return a})),function(e){e.INITIALIZED=\"initialized\",e.PUBLISH_STARTED=\"publish_started\",e.PUBLISH_FINISHED=\"publish_finished\",e.SCREEN_SHARE_EXTENSION_AVAILABLE=\"screen_share_extension_available\",e.SCREEN_SHARE_STOPPED=\"screen_share_stopped\",e.CLOSED=\"closed\",e.PONG=\"pong\",e.REFRESH_CONNECTION=\"refreshConnection\",e.ICE_CONNECTION_STATE_CHANGED=\"ice_connection_state_changed\",e.UPDATED_STATS=\"updated_stats\",e.PLAY_FINISHED=\"play_finished\",e.PLAY_STARTED=\"play_started\",e.JOINED_THE_ROOM=\"joinedTheRoom\",e.STREAM_JOINED=\"streamJoined\",e.NEW_STREAM_AVAILABLE=\"newStreamAvailable\",e.STREAM_LEAVED=\"streamLeaved\",e.LEAVED_FROM_ROOM=\"leavedFromRoom\",e.STREAM_INFORMATION=\"streamInformation\"}(a||(a={}))},OVUx:function(e,t,n){},UTbA:function(e,t,n){},VUsV:function(e,t,n){},XBQK:function(e,t,n){\"use strict\";var a=n(\"wx14\"),r=n(\"rePB\"),o=n(\"q1tI\"),i=n(\"eDIo\"),s=n(\"TSYQ\"),c=n.n(s),l=n(\"UESt\"),u=n(\"ODXe\"),d=n(\"GZ0F\"),f=n(\"2/Rp\"),p=n(\"H84U\"),b=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&\"function\"===typeof Object.getOwnPropertySymbols){var r=0;for(a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]])}return n},m=f.a.Group,h=function(e){var t=o.useContext(p.b),n=t.getPopupContainer,r=t.getPrefixCls,i=t.direction,s=e.prefixCls,l=e.type,h=e.disabled,v=e.onClick,g=e.htmlType,O=e.children,y=e.className,R=e.overlay,j=e.trigger,_=e.align,w=e.visible,E=e.onVisibleChange,S=e.placement,I=e.getPopupContainer,T=e.href,x=e.icon,k=void 0===x?o.createElement(d.a,null):x,P=e.title,A=e.buttonsRender,N=b(e,[\"prefixCls\",\"type\",\"disabled\",\"onClick\",\"htmlType\",\"children\",\"className\",\"overlay\",\"trigger\",\"align\",\"visible\",\"onVisibleChange\",\"placement\",\"getPopupContainer\",\"href\",\"icon\",\"title\",\"buttonsRender\"]),M=r(\"dropdown-button\",s),D={align:_,overlay:R,disabled:h,trigger:h?[]:j,onVisibleChange:E,getPopupContainer:I||n};\"visible\"in e&&(D.visible=w),D.placement=\"placement\"in e?S:\"rtl\"===i?\"bottomLeft\":\"bottomRight\";var L=A([o.createElement(f.a,{type:l,disabled:h,onClick:v,htmlType:g,href:T,title:P},O),o.createElement(f.a,{type:l,icon:k})]),U=Object(u.a)(L,2),B=U[0],z=U[1];return o.createElement(m,Object(a.a)({},N,{className:c()(M,y)}),B,o.createElement(C,D,z))};h.__ANT_BUTTON=!0,h.defaultProps={type:\"default\",buttonsRender:function(e){return e}};var v=h,g=n(\"uaoM\"),O=n(\"CWQg\"),y=n(\"0n0R\"),R=(Object(O.a)(\"topLeft\",\"topCenter\",\"topRight\",\"bottomLeft\",\"bottomCenter\",\"bottomRight\"),function(e){var t,n=o.useContext(p.b),s=n.getPopupContainer,u=n.getPrefixCls,d=n.direction,f=e.arrow,b=e.prefixCls,m=e.children,h=e.trigger,v=e.disabled,O=e.getPopupContainer,R=e.overlayClassName,C=u(\"dropdown\",b),j=o.Children.only(m),_=Object(y.a)(j,{className:c()(\"\".concat(C,\"-trigger\"),Object(r.a)({},\"\".concat(C,\"-rtl\"),\"rtl\"===d),j.props.className),disabled:v}),w=c()(R,Object(r.a)({},\"\".concat(C,\"-rtl\"),\"rtl\"===d)),E=v?[]:h;return E&&-1!==E.indexOf(\"contextMenu\")&&(t=!0),o.createElement(i.a,Object(a.a)({arrow:f,alignPoint:t},e,{overlayClassName:w,prefixCls:C,getPopupContainer:O||s,transitionName:function(){var t=u(),n=e.placement,a=void 0===n?\"\":n,r=e.transitionName;return void 0!==r?r:a.indexOf(\"top\")>=0?\"\".concat(t,\"-slide-down\"):\"\".concat(t,\"-slide-up\")}(),trigger:E,overlay:function(){return function(t){var n,a=e.overlay;n=\"function\"===typeof a?a():a;var r=(n=o.Children.only(\"string\"===typeof n?o.createElement(\"span\",null,n):n)).props;Object(g.a)(!r.mode||\"vertical\"===r.mode,\"Dropdown\",'mode=\"'.concat(r.mode,\"\\\" is not supported for Dropdown's Menu.\"));var i=r.selectable,s=void 0!==i&&i,c=r.focusable,u=void 0===c||c,d=r.expandIcon,f=\"undefined\"!==typeof d&&o.isValidElement(d)?d:o.createElement(\"span\",{className:\"\".concat(t,\"-menu-submenu-arrow\")},o.createElement(l.a,{className:\"\".concat(t,\"-menu-submenu-arrow-icon\")}));return\"string\"===typeof n.type?n:Object(y.a)(n,{mode:\"vertical\",selectable:s,focusable:u,expandIcon:f})}(C)},placement:function(){var t=e.placement;return void 0!==t?t:\"rtl\"===d?\"bottomRight\":\"bottomLeft\"}()}),_)});R.Button=v,R.defaultProps={mouseEnterDelay:.15,mouseLeaveDelay:.1};var C=t.a=R},iZf9:function(e,t,n){},qMfs:function(e,t,n){}}]);","extractedComments":[]}